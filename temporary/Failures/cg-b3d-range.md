---
title: カラーランプを越えて数値指定したい場合の対処法
date: 2024-03-28 
tags: Blender
categories: 3DCG
cover: img/covers/testcover.jpg
banner: 
    type: img
    bgurl: img/mainimages/flowerpots.jpg
    bannerText: 
---

## 前提
・使用ソフト:Blender
・バージョン:4.0
・レンダラー:Cycles
・言語:英語
・その他:状況がかなり限定的なので、書いた中から情報を取捨選択して使ってみてください。

# カラーランプの白黒を越えて値の範囲指定をしたい場合の対処法

## 状況
夜の街の背景を作る時に、建物に適応するEmissionの強度にランダム性を持たせる必要がありました。
今回は建物にEmissionノード向けの光るところだけを強調したテクスチャを使いました。が、流石に全部灯っていると絵面が凄いので制限することに。
　　
<img width="700" src="{% asset_path Image1.png %}" title="Image1" class="img-left" />
　　
だからといって背景の建物をいちいち刻んでマテリアルを分けるのも面倒くさいし負荷がかかる。あくまで背景です。
　　
そこでベースのTexture→Color Ramp→Strengthソケットと繋いできたんですが、
Color Rampでは黒→白の０～１までしか表すことができません。
ただの範囲指定であればそれで十分なんですが、今回の場合は光を扱うため上限値を１より大きく指定したいわけです。
　　
まとめると、０～１を０～無限に拡張したい感じです。
　　
## 対処法

結論としては、Mixノード(Float)を噛ませることで解決しました。
　　
<img width="700" src="{% asset_path Image2.png %}" title="Image2" class="img-left" />
  
<img width="700" src="{% asset_path Image3.png %}" title="Image3" class="img-left" />


## 余談
　　
ここからは私のイメージなので実際はどうなのかわかりませんが、頑張って言語化してみます。
　　
ノイズ(制限)の範囲+強さの値として使っていたColor Rampを、設定した値の分布を設定するものとして使うことで、Emissionの強さを0~10の間で管理できるようになるということだと思います。
単色であれば管理は楽ですが、今回はテクスチャを使った色をベースにするため、このような手段を取りました。
　　
とはいえ分布の形はノイズテクスチャをベースにしているため、拡大してみると綺麗に分割できているわけではないので背景とかに使うような手札っぽいですね。
背景レベルの距離じゃなかったら、普通にナイフツールなりで切って複製してEmission適応するだけなので問題はないと思います。
　　
・Noise Texture→光る、光らないのマップのベース
・Color Ramp→しきい値を調整、MixノードのFactorに繋いで値の振り分けを行う
・Mix(Float)→希望するStrengthの値の範囲を設定
　　
MixノードのColorで振り分けてStrengthを普通に上げる方法もありそうですが、テクスチャ自体の色の明暗によって状況が変わりそうなのでポンコツの僕は諦めました。